<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Gifted Child Assessment Tool</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link rel="stylesheet" href="styles.css"> <style>
        /* Define custom colors and fonts for Tailwind and clean up body styles */
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@400;700&display=swap');

        body { 
            font-family: 'Lato', sans-serif; 
            background: #FAFAFA; /* Off-white */
            color: #2F2F2F; /* Charcoal */
            padding-top: 80px; /* Space for fixed header */
        }

        .font-header { font-family: 'Playfair Display', serif; }

        /* Custom Colors for utility classes (approximating new theme with Tailwind scale) */
        .bg-custom-cream { background-color: #FAF7F0; }
        .text-custom-charcoal { color: #2F2F2F; }
        .bg-custom-sage-light { background-color: #f2f5f3; }
        .border-custom-sage { border-color: #7C9885; }
        .bg-custom-sage { background-color: #7C9885; }
        .text-custom-sage { color: #7C9885; }
        .bg-custom-gold { background-color: #D4AF37; }
        .border-custom-gold { border-color: #D4AF37; }
        .text-custom-gold { color: #D4AF37; }
        .text-custom-red { color: #D4A5A5; } /* Using Dusty Rose as a secondary accent/error */
    </style>
</head>
<body class="bg-slate-50">
    
   <div id="navigation-placeholder"></div>
<script>
    fetch('navigation.html').then(response => response.text()).then(data => {
        document.getElementById('navigation-placeholder').innerHTML = data;
    });
</script>
        // Use Fetch to inject components above/below React root
        fetch('navigation.html').then(response => response.text()).then(data => {
            document.getElementById('navigation-placeholder').innerHTML = data;
        });
        fetch('footer.html').then(response => response.text()).then(data => {
            document.getElementById('footer-placeholder').innerHTML = data;
        });
    </script>
    <script src="script.js"></script>

    <script type="text/babel">
        // --- SETUP: Destructure Hooks ---
        const { useState, useRef } = React;

        // --- SETUP: Define Icons manually (replacing lucide-react imports) ---
        // (Icons wrapper remains the same)
        const IconWrapper = ({ children, className, ...props }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width="24" height="24" viewBox="0 0 24 24" 
                fill="none" stroke="currentColor" strokeWidth="2" 
                strokeLinecap="round" strokeLinejoin="round"
                className={className} 
                {...props}
            >
                {children}
            </svg>
        );

        const ClipboardCopy = (props) => (
            <IconWrapper {...props}><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/></IconWrapper>
        );
        const ChevronRight = (props) => (
            <IconWrapper {...props}><path d="m9 18 6-6-6-6"/></IconWrapper>
        );
        const ChevronLeft = (props) => (
            <IconWrapper {...props}><path d="m15 18-6-6 6-6"/></IconWrapper>
        );
        const RotateCcw = (props) => (
            <IconWrapper {...props}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></IconWrapper>
        );
        const CheckCircle = (props) => (
            <IconWrapper {...props}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></IconWrapper>
        );
        const BarChart3 = (props) => (
            <IconWrapper {...props}><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></IconWrapper>
        );
        const AlertCircle = (props) => (
            <IconWrapper {...props}><circle cx="12" cy="12" r="10"/><line x1="12" x2="12" y1="8" y2="12"/><line x1="12" x2="12.01" y1="16" y2="16"/></IconWrapper>
        );

        // --- DATA CONSTANTS (SECTIONS and SCALE remain the same) ---
        const SECTIONS = [
          {
            id: 'ef',
            title: 'Section 1: Executive Function (EF)',
            description: 'Assesses inhibition, working memory, task initiation, and planning.',
            questions: [
              "My child interrupts conversations, lessons, or directions before others finish speaking.",
              "My child reacts emotionally (anger, tears, frustration) faster than expected for their age.",
              "My child speaks or acts before thinking through consequences.",
              "My child forgets multi-step instructions unless they are repeated.",
              "My child needs frequent reminders to stay on track with a task.",
              "My child leaves tasks unfinished because they forget what they were doing.",
              "My child delays starting tasks even when they understand what to do.",
              "My child has difficulty shifting from a preferred activity to a required task.",
              "My child waits until the last minute to start homework or chores.",
              "My child struggles to decide where to start when given multiple tasks.",
              "My child has a messy workspace and loses needed materials.",
              "My child underestimates how long tasks will take.",
              "My child becomes upset when plans change unexpectedly.",
              "My child has difficulty trying a different strategy if the first one doesn't work.",
              "My child insists on doing things 'their way' even when a simpler method exists."
            ]
          },
          {
            id: 'sensory',
            title: 'Section 2: Sensory Regulation',
            description: 'Assesses overstimulation and sensory seeking/avoiding behaviors.',
            questions: [
              "My child becomes overwhelmed by loud noises, smells, textures, or visual clutter.",
              "Small sensory interruptions (tapping, humming, movement) derail their focus.",
              "My child avoids certain clothing, foods, or environments due to sensory discomfort.",
              "My child needs movement breaks to stay regulated while working.",
              "My child describes sensory experiences as 'too much,' 'too loud,' or 'too tight.'",
              "My child gets overstimulated in busy environments and needs time to decompress.",
              "My child covers ears, hides, or withdraws when overstimulated."
            ]
          },
          {
            id: 'emotional',
            title: 'Section 3: Emotional Interpretation & Regulation',
            description: 'Assesses emotional resilience and rejection sensitivity.',
            questions: [
              "My child interprets correction as criticism or personal failure.",
              "My child becomes upset if they cannot do something perfectly on the first try.",
              "My child shuts down or refuses to continue when frustrated.",
              "My child struggles to name or describe their feelings in the moment.",
              "My child takes things personally even when no offense is intended.",
              "My child gets stuck in negative thoughts after making a mistake.",
              "My child avoids tasks that previously caused emotional discomfort."
            ]
          },
          {
            id: 'motivation',
            title: 'Section 4: Motivation Architecture',
            description: 'Assesses what drives engagement versus disengagement.',
            questions: [
              "My child works more effectively when allowed to choose the order/method of tasks.",
              "My child prefers easy tasks they can win rather than challenging tasks they might fail.",
              "My child gives up quickly when something is difficult.",
              "My child needs to understand the 'why' behind an assignment before engaging.",
              "My child becomes highly motivated when tasks connect to their passions.",
              "My child resists work that feels pointless or repetitive.",
              "My child becomes absorbed in topics they love and loses track of time."
            ]
          },
          {
            id: 'avoidance',
            title: 'Section 5: Task Avoidance / Cognitive Friction',
            description: 'Assesses specific anxiety or overwhelm related to work.',
            questions: [
              "My child freezes or goes blank when a task feels too big or confusing.",
              "My child becomes angry, silly, or chaotic when overwhelmed by schoolwork.",
              "My child avoids tasks that require long periods of attention.",
              "My child struggles to restart a task after taking a break.",
              "My child 'checks out' mentally when stressed or overstimulated.",
              "My child gets stuck thinking about doing the task instead of actually starting."
            ]
          },
          {
            id: 'selfconcept',
            title: 'Section 6: Self-Concept, Confidence & Identity',
            description: 'Assesses internal narrative and self-esteem.',
            questions: [
              "My child worries they are 'not good enough' even when their performance is excellent.",
              "My child compares themselves to others frequently.",
              "My child has trouble celebrating success because they focus on what went wrong.",
              "My child avoids trying new things to protect their self-esteem."
            ]
          },
          {
            id: 'learning',
            title: 'Section 7: Learning Style & Cognitive Preferences',
            description: 'Identifies preferred modalities for input.',
            questions: [
              "My child learns best by touching, moving, or physically interacting with materials.",
              "My child learns best when information is visual (charts, drawings, videos).",
              "My child learns best when information is spoken or discussed.",
              "My child gets bored with slow-paced teaching or rigid instruction."
            ]
          }
        ];

        const SCALE = [
          { value: 0, label: 'Never' },
          { value: 1, label: 'Rarely' },
          { value: 2, label: 'Sometimes' },
          { value: 3, label: 'Often' },
          { value: 4, label: 'Almost Always' }
        ];

        // --- MAIN APP COMPONENT ---
        function GiftedAssessmentApp() {
          const [currentSectionIndex, setCurrentSectionIndex] = useState(0);
          const [answers, setAnswers] = useState({});
          const [showResults, setShowResults] = useState(false);
          const [copied, setCopied] = useState(false);
          const topRef = useRef(null);

          const currentSection = SECTIONS[currentSectionIndex];

          const getQuestionId = (sectionIndex, questionIndex) => `${sectionIndex}-${questionIndex}`;

          const handleOptionSelect = (sectionIndex, questionIndex, value) => {
            setAnswers(prev => ({
              ...prev,
              [getQuestionId(sectionIndex, questionIndex)]: value
            }));
          };

          const calculateSectionScore = (sectionIndex) => {
            const section = SECTIONS[sectionIndex];
            let score = 0;
            let maxScore = section.questions.length * 4;
            let answeredCount = 0;

            section.questions.forEach((_, qIndex) => {
              const val = answers[getQuestionId(sectionIndex, qIndex)];
              if (val !== undefined) {
                score += val;
                answeredCount++;
              }
            });

            return { score, maxScore, percentage: maxScore > 0 ? Math.round((score / maxScore) * 100) : 0, answeredCount, totalQuestions: section.questions.length };
          };

          const isSectionComplete = (sectionIndex) => {
            const section = SECTIONS[sectionIndex];
            return section.questions.every((_, qIdx) => answers[getQuestionId(sectionIndex, qIdx)] !== undefined);
          };

          const handleNext = () => {
            if (currentSectionIndex < SECTIONS.length - 1) {
              setCurrentSectionIndex(prev => prev + 1);
              window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
              setShowResults(true);
              window.scrollTo({ top: 0, behavior: 'smooth' });
            }
          };

          const handlePrev = () => {
            if (currentSectionIndex > 0) {
              setCurrentSectionIndex(prev => prev - 1);
              window.scrollTo({ top: 0, behavior: 'smooth' });
            }
          };

          const generateReport = () => {
            let report = "GIFTED CHILD DEVELOPMENT ASSESSMENT REPORT\n";
            report += "========================================\n\n";
            
            SECTIONS.forEach((section, idx) => {
              const stats = calculateSectionScore(idx);
              report += `${section.title}\n`;
              report += `Score: ${stats.score} / ${stats.maxScore} (${stats.percentage}%)\n`;
              
              let intensity = "Low";
              if (stats.percentage > 75) intensity = "Very High";
              else if (stats.percentage > 50) intensity = "High";
              else if (stats.percentage > 25) intensity = "Moderate";
              
              report += `Intensity/Frequency: ${intensity}\n\n`;
            });

            report += "RAW DATA (JSON Format for AI Analysis):\n";
            report += JSON.stringify(answers);
            
            return report;
          };

          const copyToClipboard = () => {
            const report = generateReport();
            navigator.clipboard.writeText(report);
            setCopied(true);
            setTimeout(() => setCopied(false), 2000);
          };

          if (showResults) {
            return (
              <div className="min-h-screen bg-slate-50 p-4 md:p-8 pt-20 font-sans text-slate-800">
                <div className="max-w-3xl mx-auto bg-white shadow-xl rounded-2xl overflow-hidden" style={{ border: '1px solid #FAF7F0' }}>
                  <div className="bg-custom-sage p-6 text-white text-center">
                    <BarChart3 className="w-12 h-12 mx-auto mb-4 bg-custom-gold p-2 rounded-full" />
                    <h1 className="text-3xl font-bold mb-2">Assessment Results</h1>
                    <p className="opacity-90">Analysis of 7 developmental domains</p>
                  </div>

                  <div className="p-6 md:p-8 space-y-8">
                    {SECTIONS.map((section, idx) => {
                      const stats = calculateSectionScore(idx);
                      const isHigh = stats.percentage >= 60;
                      
                      return (
                        <div key={section.id} className="border-b border-custom-sage-light pb-6 last:border-0">
                          <div className="flex justify-between items-end mb-2">
                            <h3 className="text-lg font-bold text-custom-charcoal">{section.title}</h3>
                            <span className={`font-mono font-bold ${isHigh ? 'text-custom-red' : 'text-custom-sage'}`}>
                              {stats.score}/{stats.maxScore}
                            </span>
                          </div>
                          
                          {/* Progress Bar */}
                          <div className="w-full bg-custom-cream rounded-full h-3 mb-2">
                            <div 
                              className={`h-3 rounded-full transition-all duration-500`}
                              style={{ 
                                width: `${stats.percentage}%`, 
                                backgroundColor: stats.percentage > 60 ? '#D4A5A5' : '#7C9885' 
                              }}
                            ></div>
                          </div>
                          <p className="text-sm text-slate-500">{section.description}</p>
                        </div>
                      );
                    })}

                    <div className="bg-custom-sage-light p-6 rounded-xl mt-8">
                      <h3 className="font-bold text-custom-sage mb-3 flex items-center">
                        <AlertCircle className="w-5 h-5 mr-2" />
                        Next Steps
                      </h3>
                      <p className="text-sm text-slate-600 mb-4">
                        These results are ready to be analyzed by your coaching system. 
                        Click below to copy the structured data.
                      </p>
                      
                      <button
                        onClick={copyToClipboard}
                        className="w-full py-3 px-4 bg-custom-sage hover:bg-custom-gold text-white rounded-lg font-medium flex items-center justify-center transition-colors shadow-md"
                      >
                        {copied ? (
                          <>
                            <CheckCircle className="w-5 h-5 mr-2" />
                            Copied to Clipboard!
                          </>
                        ) : (
                          <>
                            <ClipboardCopy className="w-5 h-5 mr-2" />
                            Copy Results for AI Coach
                          </>
                        )}
                      </button>
                    </div>

                    <button 
                      onClick={() => {
                        setShowResults(false);
                        setCurrentSectionIndex(0);
                        setAnswers({});
                        window.scrollTo(0,0);
                      }}
                      className="w-full py-3 text-slate-500 hover:text-custom-sage flex items-center justify-center"
                    >
                      <RotateCcw className="w-4 h-4 mr-2" />
                      Start Over
                    </button>
                  </div>
                </div>
              </div>
            );
          }

          return (
              <div className="min-h-screen bg-slate-50 p-4 md:p-8 pt-20 font-sans text-slate-800" ref={topRef}>
              <div className="max-w-3xl mx-auto">
                
                {/* Header */}
                <div className="mb-8 text-center">
                  <h1 className="text-2xl md:text-3xl font-bold text-custom-charcoal font-header">Parent Assessment Tool</h1>
                  <p className="text-slate-500">Executive Function, Sensory, & Emotional Interpretation</p>
                </div>

                {/* Progress Indicator */}
                <div className="mb-6 flex justify-between text-xs font-semibold text-slate-400 uppercase tracking-wider">
                  <span>Section {currentSectionIndex + 1} of {SECTIONS.length}</span>
                  <span>{Math.round(((currentSectionIndex) / SECTIONS.length) * 100)}% Complete</span>
                </div>
                <div className="w-full bg-custom-cream rounded-full h-2 mb-8">
                  <div 
                    className="bg-custom-sage h-2 rounded-full transition-all duration-300" 
                    style={{ width: `${((currentSectionIndex) / SECTIONS.length) * 100}%` }}
                  ></div>
                </div>

                {/* Card */}
                <div className="bg-white shadow-lg rounded-2xl overflow-hidden mb-8" style={{ border: '1px solid #FAF7F0' }}>
                  <div className="bg-custom-sage-light p-6 border-b border-custom-sage-light">
                    <h2 className="text-xl font-bold text-custom-sage font-header">{currentSection.title}</h2>
                    <p className="text-custom-charcoal text-sm">{currentSection.description}</p>
                  </div>

                  <div className="p-6 md:p-8 space-y-8">
                    {currentSection.questions.map((q, qIdx) => {
                      const questionId = getQuestionId(currentSectionIndex, qIdx);
                      const currentValue = answers[questionId];

                      return (
                        <div key={qIdx} className="space-y-3">
                          <p className="font-medium text-custom-charcoal text-lg leading-relaxed font-body">{q}</p>
                          
                          <div className="grid grid-cols-5 gap-2 md:gap-4 pt-2">
                            {SCALE.map((s) => (
                              <button
                                key={s.value}
                                onClick={() => handleOptionSelect(currentSectionIndex, qIdx, s.value)}
                                className={`
                                  flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-200 border-2
                                  ${currentValue === s.value 
                                    ? 'border-custom-gold bg-custom-cream text-custom-charcoal shadow-md transform scale-105' 
                                    : 'border-slate-100 hover:border-custom-sage-light hover:bg-slate-50 text-slate-400'
                                  }
                                `}
                              >
                                <span className={`text-xl font-bold mb-1 ${currentValue === s.value ? 'text-custom-sage' : 'text-slate-300'}`}>
                                  {s.value}
                                </span>
                                <span className="text-[10px] uppercase font-bold tracking-wider hidden md:block">
                                  {s.label}
                                </span>
                              </button>
                            ))}
                          </div>
                          <div className="flex justify-between md:hidden text-xs text-slate-400 px-1">
                            <span>Never</span>
                            <span>Always</span>
                          </div>
                        </div>
                      );
                    })}
                  </div>

                  {/* Navigation Footer */}
                  <div className="p-6 bg-custom-cream border-t border-custom-sage-light flex justify-between items-center">
                    <button
                      onClick={handlePrev}
                      disabled={currentSectionIndex === 0}
                      className={`flex items-center px-4 py-2 rounded-lg font-medium transition-colors ${
                        currentSectionIndex === 0 
                          ? 'text-slate-400 cursor-not-allowed' 
                          : 'text-custom-charcoal hover:bg-custom-sage-light'
                      }`}
                    >
                      <ChevronLeft className="w-5 h-5 mr-1" />
                      Back
                    </button>

                    <button
                      onClick={handleNext}
                      disabled={!isSectionComplete(currentSectionIndex)}
                      className={`flex items-center px-6 py-3 rounded-lg font-bold shadow-lg transition-all transform ${
                        isSectionComplete(currentSectionIndex)
                          ? 'bg-custom-sage hover:bg-custom-gold text-white hover:-translate-y-1'
                          : 'bg-slate-300 text-slate-500 cursor-not-allowed'
                      }`}
                    >
                      {currentSectionIndex === SECTIONS.length - 1 ? 'Finish Assessment' : 'Next Section'}
                      <ChevronRight className="w-5 h-5 ml-1" />
                    </button>
                  </div>
                </div>

              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<GiftedAssessmentApp />);
    </script>
</body>
</html>
